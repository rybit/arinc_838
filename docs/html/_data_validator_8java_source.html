<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ARINC 838: D:/code/Java/arinc_838/src/main/java/edu/cmu/sv/arinc838/validation/DataValidator.java Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ARINC 838
   &#160;<span id="projectnumber">0.2</span>
   </div>
   <div id="projectbrief">A prototype system capable of installing various types of software onto a mock avionics unit following the ARINC 838 standard.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_data_validator_8java.html','');
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">D:/code/Java/arinc_838/src/main/java/edu/cmu/sv/arinc838/validation/DataValidator.java</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2012 Chris Ellison, Mike Deats, Liron Yahdav, Ryan Neal,</span>
<a name="l00003"></a>00003 <span class="comment"> * Brandon Sutherlin, Scott Griffin</span>
<a name="l00004"></a>00004 <span class="comment"> * </span>
<a name="l00005"></a>00005 <span class="comment"> * This software is released under the MIT license</span>
<a name="l00006"></a>00006 <span class="comment"> * (http://www.opensource.org/licenses/mit-license.php)</span>
<a name="l00007"></a>00007 <span class="comment"> * </span>
<a name="l00008"></a>00008 <span class="comment"> * Created on Feb 12, 2012</span>
<a name="l00009"></a>00009 <span class="comment"> */</span>
<a name="l00010"></a>00010 <span class="keyword">package </span>edu.cmu.sv.arinc838.validation;
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="keyword">import</span> java.util.ArrayList;
<a name="l00013"></a>00013 <span class="keyword">import</span> java.util.Arrays;
<a name="l00014"></a>00014 <span class="keyword">import</span> java.util.HashMap;
<a name="l00015"></a>00015 <span class="keyword">import</span> java.util.List;
<a name="l00016"></a>00016 <span class="keyword">import</span> java.util.Map;
<a name="l00017"></a>00017 <span class="keyword">import</span> java.util.regex.Matcher;
<a name="l00018"></a>00018 <span class="keyword">import</span> java.util.regex.Pattern;
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">import</span> javax.xml.XMLConstants;
<a name="l00021"></a>00021 <span class="keyword">import</span> javax.xml.stream.XMLStreamReader;
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="keyword">import</span> edu.cmu.sv.arinc838.dao.FileDefinitionDao;
<a name="l00024"></a>00024 <span class="keyword">import</span> edu.cmu.sv.arinc838.dao.IntegrityDefinitionDao.IntegrityType;
<a name="l00025"></a>00025 <span class="keyword">import</span> edu.cmu.sv.arinc838.dao.SoftwareDefinitionFileDao;
<a name="l00026"></a>00026 <span class="keyword">import</span> edu.cmu.sv.arinc838.dao.SoftwareDescriptionDao;
<a name="l00027"></a>00027 <span class="keyword">import</span> edu.cmu.sv.arinc838.util.Converter;
<a name="l00028"></a>00028 
<a name="l00083"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html">00083</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html">DataValidator</a> {
<a name="l00087"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#accde61902acbf4e9a070bf38a511899c">00087</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#accde61902acbf4e9a070bf38a511899c">XML_VERSION</a> = <span class="stringliteral">&quot;1.0&quot;</span>;
<a name="l00091"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#adf12fbf5a9988e56cc03930daca8f14b">00091</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#adf12fbf5a9988e56cc03930daca8f14b">XML_ENCODING</a> = <span class="stringliteral">&quot;utf-8&quot;</span>;
<a name="l00092"></a>00092 
<a name="l00096"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ae11fbcf08724665953420719e2f01411">00096</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ae11fbcf08724665953420719e2f01411">STR64K_MAX_LENGTH</a> = 65535;
<a name="l00097"></a>00097 
<a name="l00101"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#aacdbeb95972e0654a732f719400b97de">00101</a>         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#aacdbeb95972e0654a732f719400b97de">HEXBIN64K_MAX_LENGTH</a> = 32768;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103         <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] INVALID_DATA_FILE_EXTENSIONS = { <span class="stringliteral">&quot;bdf&quot;</span>, <span class="stringliteral">&quot;crc&quot;</span>, <span class="stringliteral">&quot;dir&quot;</span>, <span class="stringliteral">&quot;hdr&quot;</span>, <span class="stringliteral">&quot;ldr&quot;</span>, <span class="stringliteral">&quot;lci&quot;</span>, <span class="stringliteral">&quot;lcl&quot;</span>,
<a name="l00104"></a>00104                         <span class="stringliteral">&quot;lcs&quot;</span>, <span class="stringliteral">&quot;lna&quot;</span>, <span class="stringliteral">&quot;lnd&quot;</span>, <span class="stringliteral">&quot;lnl&quot;</span>, <span class="stringliteral">&quot;lno&quot;</span>, <span class="stringliteral">&quot;lnr&quot;</span>, <span class="stringliteral">&quot;lns&quot;</span>, <span class="stringliteral">&quot;lub&quot;</span>, <span class="stringliteral">&quot;luh&quot;</span>, <span class="stringliteral">&quot;lui&quot;</span>, <span class="stringliteral">&quot;lum&quot;</span>, <span class="stringliteral">&quot;lur&quot;</span>, <span class="stringliteral">&quot;lus&quot;</span>, <span class="stringliteral">&quot;xdf&quot;</span> };
<a name="l00105"></a>00105 
<a name="l00109"></a>00109         <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, String&gt; ATTRIB_VALUE_MAP = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
<a name="l00110"></a>00110         <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, String&gt; NS_PREFIX_URI_MAP = <span class="keyword">new</span> HashMap&lt;String, String&gt;();
<a name="l00111"></a>00111 
<a name="l00115"></a>00115         <span class="keyword">static</span> {
<a name="l00116"></a>00116                 ATTRIB_VALUE_MAP.put(<span class="stringliteral">&quot;schemaLocation&quot;</span>, <span class="stringliteral">&quot;http://www.arinc.com&quot;</span>);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118                 NS_PREFIX_URI_MAP.put(<span class="stringliteral">&quot;xsi&quot;</span>, XMLConstants.W3C_XML_SCHEMA_INSTANCE_NS_URI);
<a name="l00119"></a>00119                 NS_PREFIX_URI_MAP.put(<span class="stringliteral">&quot;sdf&quot;</span>, <span class="stringliteral">&quot;http://www.arinc.com/arinc838&quot;</span>);
<a name="l00120"></a>00120         }
<a name="l00121"></a>00121 
<a name="l00131"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a9a7420b665e883afb0d9e55aabb1070b">00131</a>         <span class="keyword">public</span> <span class="keywordtype">long</span> <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a9a7420b665e883afb0d9e55aabb1070b">validateUint32</a>(<span class="keywordtype">long</span> value) {
<a name="l00132"></a>00132                 <span class="keywordflow">if</span> ((value &gt;= 0) &amp;&amp; (value &lt;= (<span class="keywordtype">long</span>) Math.pow(2, 32))) {
<a name="l00133"></a>00133                         <span class="keywordflow">return</span> value;
<a name="l00134"></a>00134                 } <span class="keywordflow">else</span> {
<a name="l00135"></a>00135                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;The value &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39; is not an unsigned, 32-bit integer&quot;</span>);
<a name="l00136"></a>00136                 }
<a name="l00137"></a>00137         }
<a name="l00138"></a>00138 
<a name="l00148"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a1669bc4e944a14d1143cecb55ebe45a9">00148</a>         <span class="keyword">public</span> List&lt;Exception&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a1669bc4e944a14d1143cecb55ebe45a9">validateStr64kBinary</a>(String value) {
<a name="l00149"></a>00149                 ArrayList&lt;Exception&gt; errors = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();
<a name="l00150"></a>00150 
<a name="l00151"></a>00151                 <span class="keywordflow">if</span> (value == null) {
<a name="l00152"></a>00152                         errors.add(<span class="keyword">new</span> IllegalArgumentException(
<a name="l00153"></a>00153                                         <span class="stringliteral">&quot;The input value cannot be null&quot;</span>));
<a name="l00154"></a>00154                 } <span class="keywordflow">else</span> {
<a name="l00155"></a>00155 
<a name="l00156"></a>00156                         String checked = <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_xml_formatter.html">XmlFormatter</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_xml_formatter.html#a9f095b40b3ef0bf1b0d5d27d8c4624da">unescapeXmlSpecialChars</a>(value);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158                         <span class="keywordflow">try</span> {
<a name="l00159"></a>00159                                 checked = checkForNonASCII(checked);
<a name="l00160"></a>00160                         } <span class="keywordflow">catch</span> (Exception e) {
<a name="l00161"></a>00161                                 errors.add(e);
<a name="l00162"></a>00162                         }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164                         <span class="keywordflow">if</span> (checked.length() &gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ae11fbcf08724665953420719e2f01411">STR64K_MAX_LENGTH</a>) {
<a name="l00165"></a>00165                                 errors.add(<span class="keyword">new</span> IllegalArgumentException(
<a name="l00166"></a>00166                                                 <span class="stringliteral">&quot;The input value length of &quot;</span>
<a name="l00167"></a>00167                                                                 + checked.length()
<a name="l00168"></a>00168                                                                 + <span class="stringliteral">&quot; exceeds the maximum allowed characters of 65535&quot;</span>));
<a name="l00169"></a>00169                         }
<a name="l00170"></a>00170                 }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172                 <span class="keywordflow">return</span> errors;
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175         <span class="keyword">private</span> String checkForNonASCII(String value) {
<a name="l00176"></a>00176 
<a name="l00177"></a>00177                 Pattern p = Pattern.compile(<span class="stringliteral">&quot;[^\\p{ASCII}]&quot;</span>);
<a name="l00178"></a>00178                 Matcher m = p.matcher(value);
<a name="l00179"></a>00179 
<a name="l00180"></a>00180                 <span class="keywordflow">if</span> (m.find()) {
<a name="l00181"></a>00181                         <span class="keywordtype">int</span> index = m.start();
<a name="l00182"></a>00182                         <span class="keywordtype">char</span> illegal = value.charAt(index);
<a name="l00183"></a>00183                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Non-ASCII character &#39;&quot;</span>
<a name="l00184"></a>00184                                         + illegal + <span class="stringliteral">&quot;&#39; found at index &quot;</span> + index);
<a name="l00185"></a>00185                 }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187                 <span class="keywordflow">return</span> value;
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189 
<a name="l00204"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a64b8d8661b1f5abc96e0cde020a2f5aa">00204</a>         <span class="keyword">public</span> List&lt;Exception&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a64b8d8661b1f5abc96e0cde020a2f5aa">validateStr64kXml</a>(String value) {
<a name="l00205"></a>00205                 ArrayList&lt;Exception&gt; errors = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();
<a name="l00206"></a>00206                 <span class="keywordflow">if</span> (value == null) {
<a name="l00207"></a>00207                         errors.add(<span class="keyword">new</span> IllegalAccessException(<span class="stringliteral">&quot;Str64k cannot be null&quot;</span>));
<a name="l00208"></a>00208                         <span class="keywordflow">return</span> errors;
<a name="l00209"></a>00209                 }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211                 errors.addAll(<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a1669bc4e944a14d1143cecb55ebe45a9">validateStr64kBinary</a>(value));
<a name="l00212"></a>00212 
<a name="l00213"></a>00213                 <span class="keywordflow">try</span> {
<a name="l00214"></a>00214                         <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a718435f1045b0b50b5f77feb0be99dd9">checkForEscapedXMLChars</a>(value);
<a name="l00215"></a>00215                 } <span class="keywordflow">catch</span> (IllegalArgumentException e) {
<a name="l00216"></a>00216                         errors.add(e);
<a name="l00217"></a>00217                 }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219                 <span class="keywordflow">return</span> errors;
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221 
<a name="l00231"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ae006c7f37b96941e9c9f5630eea71b26">00231</a>         <span class="keyword">public</span> List&lt;?&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ae006c7f37b96941e9c9f5630eea71b26">validateList1</a>(List&lt;?&gt; value) {
<a name="l00232"></a>00232 
<a name="l00233"></a>00233                 <span class="keywordflow">if</span> (value == null) {
<a name="l00234"></a>00234                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;A LIST1 cannot be null&quot;</span>);
<a name="l00235"></a>00235                 }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237                 <span class="keywordflow">if</span> (value.size() &lt; 1) {
<a name="l00238"></a>00238                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;A LIST1 must have a size &gt;= 1.&quot;</span>);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240                 }
<a name="l00241"></a>00241                 <span class="keywordflow">return</span> value;
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243 
<a name="l00254"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a718435f1045b0b50b5f77feb0be99dd9">00254</a>         <span class="keyword">public</span> String <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a718435f1045b0b50b5f77feb0be99dd9">checkForEscapedXMLChars</a>(String value) {
<a name="l00255"></a>00255                 <span class="keywordtype">int</span> idx = value.indexOf(<span class="charliteral">&#39;&lt;&#39;</span>);
<a name="l00256"></a>00256                 <span class="keywordflow">if</span> (idx != -1) {
<a name="l00257"></a>00257                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Found unescaped &#39;&lt;&#39; char at index &quot;</span> + idx);
<a name="l00258"></a>00258                 }
<a name="l00259"></a>00259                 idx = value.indexOf(<span class="charliteral">&#39;&gt;&#39;</span>);
<a name="l00260"></a>00260                 <span class="keywordflow">if</span> (idx != -1) {
<a name="l00261"></a>00261                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Found unescaped &#39;&gt;&#39; char at index &quot;</span> + idx);
<a name="l00262"></a>00262                 }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264                 idx = value.indexOf(<span class="charliteral">&#39;&amp;&#39;</span>);
<a name="l00265"></a>00265 
<a name="l00266"></a>00266                 <span class="keywordflow">if</span> (idx != -1 &amp;&amp; !value.matches(<span class="stringliteral">&quot;.*((&amp;amp)|(&amp;lt)|(&amp;gt)).*&quot;</span>)) {
<a name="l00267"></a>00267                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Found unescaped &#39;&amp;&#39; char at index &quot;</span> + idx);
<a name="l00268"></a>00268                 }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270                 <span class="keywordflow">return</span> value;
<a name="l00271"></a>00271         }
<a name="l00272"></a>00272 
<a name="l00283"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#aa03e6f99dcbc7d1eaa890ca4af69fbb3">00283</a>         <span class="keyword">public</span> byte[] <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#aa03e6f99dcbc7d1eaa890ca4af69fbb3">validateFileFormatVersion</a>(byte[] version) {
<a name="l00284"></a>00284                 <span class="keywordflow">if</span> (!Arrays.equals(version,
<a name="l00285"></a>00285                                 <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1dao_1_1_software_definition_file_dao.html">SoftwareDefinitionFileDao</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1dao_1_1_software_definition_file_dao.html#a365735731e6d0c0b50354b30d87491e9">DEFAULT_FILE_FORMAT_VERSION</a>)) {
<a name="l00286"></a>00286                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(
<a name="l00287"></a>00287                                         <span class="stringliteral">&quot;File format version was set to 0x&quot;</span>
<a name="l00288"></a>00288                                                         + <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1util_1_1_converter.html">Converter</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1util_1_1_converter.html#a630b801eb2356a97e6f832e7770d5344">bytesToHex</a>(version)
<a name="l00289"></a>00289                                                         + <span class="stringliteral">&quot;, expected 0x&quot;</span>
<a name="l00290"></a>00290                                                         + <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1util_1_1_converter.html">Converter</a>
<a name="l00291"></a>00291                                                                         .<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1util_1_1_converter.html#a630b801eb2356a97e6f832e7770d5344">bytesToHex</a>(<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1dao_1_1_software_definition_file_dao.html">SoftwareDefinitionFileDao</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1dao_1_1_software_definition_file_dao.html#a365735731e6d0c0b50354b30d87491e9">DEFAULT_FILE_FORMAT_VERSION</a>));
<a name="l00292"></a>00292                 }
<a name="l00293"></a>00293                 <span class="keywordflow">return</span> version;
<a name="l00294"></a>00294         }
<a name="l00295"></a>00295 
<a name="l00305"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ad56185f1e72a969cad580d44136e89cc">00305</a>         <span class="keyword">public</span> <span class="keywordtype">long</span> <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ad56185f1e72a969cad580d44136e89cc">validateIntegrityType</a>(<span class="keywordtype">long</span> type) {
<a name="l00306"></a>00306                 <span class="keywordflow">if</span> (IntegrityType.fromLong(type) == null) {
<a name="l00307"></a>00307                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Integrity type was invalid. Got &quot;</span> + type + <span class="stringliteral">&quot;, expected &quot;</span>
<a name="l00308"></a>00308                                                         + IntegrityType.asString());
<a name="l00309"></a>00309                 }
<a name="l00310"></a>00310                 <span class="keywordflow">return</span> type;
<a name="l00311"></a>00311         }
<a name="l00312"></a>00312 
<a name="l00323"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a8e08ec13e69b5ef36ba35cda4a947761">00323</a>         <span class="keyword">public</span> byte[] <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a8e08ec13e69b5ef36ba35cda4a947761">validateIntegrityValue</a>(byte[] value) {
<a name="l00324"></a>00324                 <span class="keywordflow">if</span> (value == null) {
<a name="l00325"></a>00325                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Integrity value cannot be null&quot;</span>);
<a name="l00326"></a>00326                 }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328                 <span class="keywordtype">int</span> size = value.length;
<a name="l00329"></a>00329 
<a name="l00330"></a>00330                 <span class="keywordflow">if</span> (size != 2 &amp;&amp; size != 4 &amp;&amp; size != 8) {
<a name="l00331"></a>00331                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Incorrect number of bytes for integrity value. Got &quot;</span> + size
<a name="l00332"></a>00332                                         + <span class="stringliteral">&quot;, expected 2, 4, or 8&quot;</span>);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334                 }
<a name="l00335"></a>00335 
<a name="l00336"></a>00336                 <span class="keywordflow">return</span> value;
<a name="l00337"></a>00337         }
<a name="l00338"></a>00338 
<a name="l00360"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a78d1ff552d10509b4732f754db667f19">00360</a>         <span class="keyword">public</span> String <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a78d1ff552d10509b4732f754db667f19">validateSoftwarePartNumber</a>(String value) {
<a name="l00361"></a>00361                 <span class="keywordflow">if</span> (value == null) {
<a name="l00362"></a>00362                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Software part number cannot be null&quot;</span>);
<a name="l00363"></a>00363                 }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365                 <span class="comment">// Just check the basic format first: MMMCC-SSSS-SSSS</span>
<a name="l00366"></a>00366                 <span class="keywordflow">if</span> (!value.matches(<span class="stringliteral">&quot;[A-Z0-9]{5}-[A-Z0-9]{4}-[A-Z0-9]{4}&quot;</span>)) {
<a name="l00367"></a>00367                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Software part number format was invalid. Got &quot;</span> + value
<a name="l00368"></a>00368                                         + <span class="stringliteral">&quot;, expected format to be &quot;</span> + <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1dao_1_1_software_description_dao.html">SoftwareDescriptionDao</a>.SOFTWARE_PART_NUMBER_FORMAT);
<a name="l00369"></a>00369                 }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371                 checkForIllegalCharsInPartNumber(value);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373                 validateCheckCharacters(value);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375                 <span class="keywordflow">return</span> value;
<a name="l00376"></a>00376         }
<a name="l00377"></a>00377 
<a name="l00396"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a8ae46a355813ce3d32c647b7cfb3c4fa">00396</a>         <span class="keyword">public</span> String <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a8ae46a355813ce3d32c647b7cfb3c4fa">generateSoftwarePartNumber</a>(String value) {
<a name="l00397"></a>00397                 <span class="keywordflow">if</span> (value == null) {
<a name="l00398"></a>00398                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Software part number cannot be null&quot;</span>);
<a name="l00399"></a>00399                 }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401                 checkForIllegalCharsInPartNumber(value);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403                 String check = generateCheckCharacters(value);
<a name="l00404"></a>00404                 String fullPart = value.substring(0, 3) + check + value.substring(5);
<a name="l00405"></a>00405 
<a name="l00406"></a>00406                 <span class="keywordflow">return</span> <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a78d1ff552d10509b4732f754db667f19">validateSoftwarePartNumber</a>(fullPart);
<a name="l00407"></a>00407         }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409         <span class="keyword">private</span> String checkForIllegalCharsInPartNumber(String value) {
<a name="l00410"></a>00410                 String partNumber = null;
<a name="l00411"></a>00411                 <span class="keywordflow">try</span> {
<a name="l00412"></a>00412                         partNumber = value.substring(value.indexOf(<span class="charliteral">&#39;-&#39;</span>) + 1);
<a name="l00413"></a>00413                 } <span class="keywordflow">catch</span> (StringIndexOutOfBoundsException e) {
<a name="l00414"></a>00414                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Software part number format was invalid. Got &quot;</span> + value
<a name="l00415"></a>00415                                         + <span class="stringliteral">&quot;, expected format to be &quot;</span> + SoftwareDescriptionDao.SOFTWARE_PART_NUMBER_FORMAT);
<a name="l00416"></a>00416                 }
<a name="l00417"></a>00417                 <span class="comment">// check for illegal characters in the SSSS-SSSS (part number) section</span>
<a name="l00418"></a>00418                 Pattern p = Pattern.compile(<span class="stringliteral">&quot;[iIoOqQzZ]&quot;</span>);
<a name="l00419"></a>00419                 Matcher m = p.matcher(partNumber);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421                 <span class="keywordflow">if</span> (m.find()) {
<a name="l00422"></a>00422                         <span class="keywordtype">int</span> index = m.start();
<a name="l00423"></a>00423                         <span class="keywordtype">char</span> illegal = partNumber.charAt(index);
<a name="l00424"></a>00424                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Software part number contains illegal character &#39;&quot;</span> + illegal
<a name="l00425"></a>00425                                         + <span class="stringliteral">&quot;&#39; at index &quot;</span> + index);
<a name="l00426"></a>00426                 }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428                 <span class="keywordflow">return</span> value;
<a name="l00429"></a>00429         }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431         <span class="keyword">private</span> String validateCheckCharacters(String partNumber) {
<a name="l00432"></a>00432                 String check = partNumber.substring(3, 5);
<a name="l00433"></a>00433 
<a name="l00434"></a>00434                 String checked = generateCheckCharacters(partNumber);
<a name="l00435"></a>00435                 <span class="keywordflow">if</span> (!check.equals(checked)) {
<a name="l00436"></a>00436                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(
<a name="l00437"></a>00437                                         <span class="stringliteral">&quot;Software part number check characters did not validate. Got &quot;</span>
<a name="l00438"></a>00438                                                         + checked + <span class="stringliteral">&quot;, expected &quot;</span> + check + <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00439"></a>00439                 }
<a name="l00440"></a>00440                 <span class="keywordflow">return</span> check;
<a name="l00441"></a>00441         }
<a name="l00442"></a>00442 
<a name="l00458"></a>00458         <span class="keyword">private</span> String generateCheckCharacters(String partNumber) {
<a name="l00459"></a>00459                 String data = partNumber.substring(0, 3) + partNumber.substring(6, 10) + partNumber.substring(11);
<a name="l00460"></a>00460 
<a name="l00461"></a>00461                 <span class="keywordtype">int</span> result = 0;
<a name="l00462"></a>00462                 <span class="keywordflow">for</span> (<span class="keywordtype">char</span> c : data.toCharArray()) {
<a name="l00463"></a>00463                         result = result ^ c;
<a name="l00464"></a>00464                 }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466                 <span class="keywordflow">return</span> Integer.toHexString(result).toUpperCase();
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468 
<a name="l00480"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ab9fd27221fc2d6a43612e50f5a750737">00480</a>         <span class="keyword">public</span> byte[] <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ab9fd27221fc2d6a43612e50f5a750737">validateHexbin32</a>(byte[] value) {
<a name="l00481"></a>00481 
<a name="l00482"></a>00482                 <span class="keywordflow">if</span> (value == null) {
<a name="l00483"></a>00483                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Hexbin 32 type cannot be null&quot;</span>);
<a name="l00484"></a>00484                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value.length != 4) {
<a name="l00485"></a>00485                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Hexbin 32 type must be 4 bytes&quot;</span>);
<a name="l00486"></a>00486                 }
<a name="l00487"></a>00487                 <span class="keywordflow">return</span> value;
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489 
<a name="l00500"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#afb299d4354d87d7978d51a3522e563f7">00500</a>         <span class="keyword">public</span> byte[] <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#afb299d4354d87d7978d51a3522e563f7">validateHexbin64k</a>(byte[] value) {
<a name="l00501"></a>00501                 <span class="keywordflow">if</span> (value == null) {
<a name="l00502"></a>00502                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Hexbin 64k type cannot be null&quot;</span>);
<a name="l00503"></a>00503                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value.length &gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#aacdbeb95972e0654a732f719400b97de">HEXBIN64K_MAX_LENGTH</a>) {
<a name="l00504"></a>00504                         <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Hexbin 64k type must be =&lt; &quot;</span> + <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#aacdbeb95972e0654a732f719400b97de">HEXBIN64K_MAX_LENGTH</a> + <span class="stringliteral">&quot; bytes&quot;</span>);
<a name="l00505"></a>00505                 }
<a name="l00506"></a>00506                 <span class="keywordflow">return</span> value;
<a name="l00507"></a>00507         }
<a name="l00508"></a>00508 
<a name="l00527"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ac6969a61923856977484e66eb8036175">00527</a>         <span class="keyword">public</span> List&lt;Exception&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ac6969a61923856977484e66eb8036175">validateDataFileName</a>(String fileName) {
<a name="l00528"></a>00528                 ArrayList&lt;Exception&gt; errors = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();
<a name="l00529"></a>00529                 <span class="keywordflow">if</span> (fileName == null) {
<a name="l00530"></a>00530                         errors.add(<span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;File name cannot be null&quot;</span>));
<a name="l00531"></a>00531                         <span class="keywordflow">return</span> errors;
<a name="l00532"></a>00532                 }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534                 <span class="keywordflow">if</span> (fileName.length() &gt; 255) {
<a name="l00535"></a>00535                         errors.add(<span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;File name must be &lt;= 255 characters. The length is &quot;</span>
<a name="l00536"></a>00536                                                         + fileName.length()));
<a name="l00537"></a>00537                 }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539                 <span class="comment">// check extension</span>
<a name="l00540"></a>00540                 String name = fileName;
<a name="l00541"></a>00541                 <span class="keywordflow">try</span> {
<a name="l00542"></a>00542                         name = fileName.substring(0, fileName.lastIndexOf(<span class="stringliteral">&quot;.&quot;</span>));
<a name="l00543"></a>00543                         String extension = fileName
<a name="l00544"></a>00544                                         .substring(fileName.lastIndexOf(<span class="stringliteral">&quot;.&quot;</span>) + 1);
<a name="l00545"></a>00545                         <span class="keywordflow">if</span> (Arrays.asList(INVALID_DATA_FILE_EXTENSIONS).contains(
<a name="l00546"></a>00546                                         extension.toLowerCase())) {
<a name="l00547"></a>00547                                 errors.add(<span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;File name &#39;&quot;</span>
<a name="l00548"></a>00548                                                 + fileName + <span class="stringliteral">&quot;&#39; contained an illegal extension &#39;&quot;</span>
<a name="l00549"></a>00549                                                 + extension + <span class="stringliteral">&quot;&#39;.&quot;</span>));
<a name="l00550"></a>00550                         }
<a name="l00551"></a>00551                 } <span class="keywordflow">catch</span> (StringIndexOutOfBoundsException e) {
<a name="l00552"></a>00552                         errors.add(<span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;File name &#39;&quot;</span> + fileName
<a name="l00553"></a>00553                                         + <span class="stringliteral">&quot;&#39; must have an extension, e.g. &#39;.bin&#39;&quot;</span>));
<a name="l00554"></a>00554                 }
<a name="l00555"></a>00555 
<a name="l00556"></a>00556                 <span class="comment">// check file names for bad characters</span>
<a name="l00557"></a>00557                 Pattern p = Pattern.compile(<span class="stringliteral">&quot;[\&quot;&#39;`*&lt;&gt;:;#?/\\\\|~!@$%^&amp;+=,\\s]&quot;</span>);
<a name="l00558"></a>00558                 Matcher m = p.matcher(name);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560                 <span class="keywordflow">if</span> (m.find()) {
<a name="l00561"></a>00561                         <span class="keywordtype">int</span> index = m.start();
<a name="l00562"></a>00562                         <span class="keywordtype">char</span> illegal = name.charAt(index);
<a name="l00563"></a>00563                         errors.add(<span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;File name &#39;&quot;</span> + fileName
<a name="l00564"></a>00564                                         + <span class="stringliteral">&quot;&#39; contained an illegal character &#39;&quot;</span> + illegal
<a name="l00565"></a>00565                                         + <span class="stringliteral">&quot;&#39; at index &quot;</span> + index + <span class="stringliteral">&quot;.&quot;</span>));
<a name="l00566"></a>00566                 }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568                 <span class="keywordflow">return</span> errors;
<a name="l00569"></a>00569         }
<a name="l00570"></a>00570 
<a name="l00581"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a7637f18bf1c1dea95c47decd8ec69990">00581</a>         <span class="keyword">public</span> List&lt;Exception&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a7637f18bf1c1dea95c47decd8ec69990">validateDataFileNamesAreUnique</a>(List&lt;FileDefinitionDao&gt; fileDefs) {
<a name="l00582"></a>00582                 ArrayList&lt;Exception&gt; errors = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();
<a name="l00583"></a>00583                 <span class="comment">// map of lower case file names to list of actual file names</span>
<a name="l00584"></a>00584                 Map&lt;String, List&lt;String&gt;&gt; fileNames = <span class="keyword">new</span> HashMap&lt;String, List&lt;String&gt;&gt;();
<a name="l00585"></a>00585                 <span class="keywordflow">for</span> (<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1dao_1_1_file_definition_dao.html">FileDefinitionDao</a> fileDef : fileDefs) {
<a name="l00586"></a>00586                         List&lt;String&gt; values = fileNames.get(fileDef.getFileName()
<a name="l00587"></a>00587                                         .toLowerCase());
<a name="l00588"></a>00588                         <span class="keywordflow">if</span> (values == null) {
<a name="l00589"></a>00589                                 values = <span class="keyword">new</span> ArrayList&lt;String&gt;();
<a name="l00590"></a>00590                                 fileNames.put(fileDef.getFileName().toLowerCase(), values);
<a name="l00591"></a>00591                         }
<a name="l00592"></a>00592                         values.add(fileDef.getFileName());
<a name="l00593"></a>00593                 }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595                 <span class="keywordflow">for</span> (String lowerCaseFileNames : fileNames.keySet()) {
<a name="l00596"></a>00596                         String fileNameList = fileNames.get(lowerCaseFileNames).toString()
<a name="l00597"></a>00597                                         .replaceAll(<span class="stringliteral">&quot;^\\[|\\]$&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00598"></a>00598 
<a name="l00599"></a>00599                         <span class="keywordflow">if</span> (fileNames.get(lowerCaseFileNames).size() &gt; 1) {
<a name="l00600"></a>00600                                 errors.add(<span class="keyword">new</span> IllegalArgumentException(
<a name="l00601"></a>00601                                                 <span class="stringliteral">&quot;Duplicate data file names: &quot;</span> + fileNameList + <span class="stringliteral">&quot;.&quot;</span>));
<a name="l00602"></a>00602                         }
<a name="l00603"></a>00603                 }
<a name="l00604"></a>00604 
<a name="l00605"></a>00605                 <span class="keywordflow">return</span> errors;
<a name="l00606"></a>00606         }
<a name="l00607"></a>00607 
<a name="l00616"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a5add79dc541a0ddd8c5eacdbd850751a">00616</a>         <span class="keyword">public</span> List&lt;Exception&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#a5add79dc541a0ddd8c5eacdbd850751a">validateXmlHeaderAttributes</a>(XMLStreamReader xsr) {
<a name="l00617"></a>00617                 List&lt;Exception&gt; errors = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();
<a name="l00618"></a>00618                 Map&lt;String, String&gt; localCopy = <span class="keyword">new</span> HashMap&lt;String, String&gt;(ATTRIB_VALUE_MAP);
<a name="l00619"></a>00619 
<a name="l00620"></a>00620                 <span class="keywordtype">int</span> ncCount = xsr.getAttributeCount();
<a name="l00621"></a>00621                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncCount; ++i) {
<a name="l00622"></a>00622                         String name = xsr.getAttributeLocalName(i);
<a name="l00623"></a>00623                         String value = xsr.getAttributeValue(i);
<a name="l00624"></a>00624                         value = value.trim();
<a name="l00625"></a>00625 
<a name="l00626"></a>00626                         <span class="keywordflow">if</span> (localCopy.containsKey(name)) {
<a name="l00627"></a>00627                                 String expected = localCopy.remove(name);
<a name="l00628"></a>00628                                 <span class="keywordflow">if</span> (!value.equalsIgnoreCase(expected)) {
<a name="l00629"></a>00629                                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Attribute: &quot;</span> + name + <span class="stringliteral">&quot; is wrong. Expected: &#39;&quot;</span>
<a name="l00630"></a>00630                                                         + expected + <span class="stringliteral">&quot;&#39; found: &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l00631"></a>00631                                         errors.add(e);
<a name="l00632"></a>00632 }
<a name="l00633"></a>00633                         } <span class="keywordflow">else</span> {
<a name="l00634"></a>00634                                 Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Attribute: &#39;&quot;</span> + name + <span class="stringliteral">&quot;&#39; is unexpected.&quot;</span>);
<a name="l00635"></a>00635                                 errors.add(e);
<a name="l00636"></a>00636                         }
<a name="l00637"></a>00637                 }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639                 <span class="keywordflow">if</span> (!localCopy.isEmpty()) {
<a name="l00640"></a>00640                         String missingList = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00641"></a>00641                         <span class="keywordflow">for</span> (String item : localCopy.keySet()) {
<a name="l00642"></a>00642                                 missingList += <span class="stringliteral">&quot; &quot;</span> + item;
<a name="l00643"></a>00643                         }
<a name="l00644"></a>00644 
<a name="l00645"></a>00645                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Attributes missing: &quot;</span> + missingList);
<a name="l00646"></a>00646                         errors.add(e);
<a name="l00647"></a>00647                 }
<a name="l00648"></a>00648                 
<a name="l00649"></a>00649                 <span class="keywordflow">if</span>(xsr.standaloneSet()) {
<a name="l00650"></a>00650                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Standalone attribute should not be set.&quot;</span>);
<a name="l00651"></a>00651                         errors.add(e);
<a name="l00652"></a>00652                 }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654                 <span class="keywordflow">if</span> (!<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html">DataValidator</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#adf12fbf5a9988e56cc03930daca8f14b">XML_ENCODING</a>.equalsIgnoreCase(xsr.getCharacterEncodingScheme())) {
<a name="l00655"></a>00655                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;The XML Encoding is wrong.&quot;</span> + 
<a name="l00656"></a>00656                                         <span class="stringliteral">&quot;Expected: &quot;</span> + <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html">DataValidator</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#adf12fbf5a9988e56cc03930daca8f14b">XML_ENCODING</a> + 
<a name="l00657"></a>00657                                         <span class="stringliteral">&quot; found: &quot;</span> + xsr.getCharacterEncodingScheme());
<a name="l00658"></a>00658                         errors.add(e);
<a name="l00659"></a>00659                 }
<a name="l00660"></a>00660                 <span class="keywordflow">if</span> (!<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html">DataValidator</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#accde61902acbf4e9a070bf38a511899c">XML_VERSION</a>.equalsIgnoreCase(xsr.getVersion())) {
<a name="l00661"></a>00661                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;The XML version is wrong.&quot;</span> + 
<a name="l00662"></a>00662                                         <span class="stringliteral">&quot;Expected: &quot;</span> + <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html">DataValidator</a>.<a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#accde61902acbf4e9a070bf38a511899c">XML_VERSION</a> + 
<a name="l00663"></a>00663                                         <span class="stringliteral">&quot; found: &quot;</span> + xsr.getVersion());
<a name="l00664"></a>00664                         errors.add(e);
<a name="l00665"></a>00665                 }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667                 <span class="keywordflow">return</span> errors;
<a name="l00668"></a>00668         }
<a name="l00669"></a>00669 
<a name="l00677"></a><a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ac1a601f347c95b5a5cb5cdfa336786d9">00677</a>         <span class="keyword">public</span> List&lt;Exception&gt; <a class="code" href="classedu_1_1cmu_1_1sv_1_1arinc838_1_1validation_1_1_data_validator.html#ac1a601f347c95b5a5cb5cdfa336786d9">validateXmlHeaderNamespaces</a>(XMLStreamReader xsr) {
<a name="l00678"></a>00678                 List&lt;Exception&gt; errors = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();
<a name="l00679"></a>00679                 Map&lt;String, String&gt; localCopy = <span class="keyword">new</span> HashMap&lt;String, String&gt;(NS_PREFIX_URI_MAP);
<a name="l00680"></a>00680 
<a name="l00681"></a>00681                 <span class="keywordtype">int</span> ncCount = xsr.getNamespaceCount();
<a name="l00682"></a>00682                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncCount; ++i) {
<a name="l00683"></a>00683                         String name = xsr.getNamespacePrefix(i);
<a name="l00684"></a>00684                         String value = xsr.getNamespaceURI(i);
<a name="l00685"></a>00685                         value = value.trim();
<a name="l00686"></a>00686                         
<a name="l00687"></a>00687                         <span class="keywordflow">if</span> (localCopy.containsKey(name)) {
<a name="l00688"></a>00688                                 String expected = localCopy.remove(name);
<a name="l00689"></a>00689                                 <span class="keywordflow">if</span> (!value.equalsIgnoreCase(expected)) {
<a name="l00690"></a>00690                                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Namespace: &#39;&quot;</span> + name + <span class="stringliteral">&quot;&#39; is wrong. Expected: &#39;&quot;</span>
<a name="l00691"></a>00691                                                         + expected + <span class="stringliteral">&quot;&#39; found: &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);
<a name="l00692"></a>00692                                         errors.add(e);
<a name="l00693"></a>00693                                 }
<a name="l00694"></a>00694                         } <span class="keywordflow">else</span> {
<a name="l00695"></a>00695                                 Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Namespace Prefix: &#39;&quot;</span> + name + <span class="stringliteral">&quot;&#39; is unexpected.&quot;</span>);
<a name="l00696"></a>00696                                 errors.add(e);
<a name="l00697"></a>00697                         }
<a name="l00698"></a>00698                 }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700                 <span class="keywordflow">if</span> (!localCopy.isEmpty()) {
<a name="l00701"></a>00701                         String missingList = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00702"></a>00702                         <span class="keywordflow">for</span> (String item : localCopy.keySet()) {
<a name="l00703"></a>00703                                 missingList += <span class="stringliteral">&quot; &quot;</span> + item;
<a name="l00704"></a>00704                         }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706                         Exception e = <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Namespaces missing: &quot;</span> + missingList);
<a name="l00707"></a>00707                         errors.add(e);
<a name="l00708"></a>00708                 }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710                 <span class="keywordflow">return</span> errors;
<a name="l00711"></a>00711         }
<a name="l00712"></a>00712 }
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>DataValidator.java</b>      </li>

    <li class="footer">Generated on Mon Apr 23 2012 22:00:37 for ARINC 838 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.0 </li>
   </ul>
 </div>


</body>
</html>
